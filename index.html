<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Jogo da Cobrinha</title>
  <style>
    body {
      background-color: #1e1e1e;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: white;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: start;
      height: 100vh;
      padding-top: 20px;
    }

    canvas {
      border: 3px solid #00ff99;
      background-color: #111;
      box-shadow: 0 0 20px #00ff99;
      display: none;
    }

    #menu, #controls {
      background-color: #2b2b2b;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 15px #00ff99;
      margin-bottom: 15px;
      text-align: center;
    }

    #menu input, #menu select {
      margin: 8px 0;
      padding: 8px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
    }

    #menu label {
      margin-top: 10px;
      display: block;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      margin: 5px;
      background-color: #00ff99;
      border: none;
      color: #111;
      cursor: pointer;
      border-radius: 5px;
    }

    button:hover {
      background-color: #00cc77;
    }

    #score {
      font-size: 20px;
      margin-bottom: 10px;
      display: none;
      color: #00ff99;
      font-weight: bold;
    }

    #controls {
      display: none;
    }

    #game-over {
      color: #ff4d4d;
      font-size: 26px;
      margin-top: 10px;
      display: none;
    }
  </style>
</head>
<body>
  <!-- MENU DE PERSONALIZA√á√ÉO -->
  <div id="menu">
    <h2>üéÆ Personalize sua Cobrinha</h2>

    <label for="bodyColor">Cor do Corpo:</label>
    <select id="bodyColor">
      <option value="#00cc77">Verde</option>
      <option value="#ffcc00">Amarelo</option>
      <option value="#ff4d4d">Vermelho</option>
      <option value="#4da6ff">Azul Claro</option>
      <option value="#cccccc">Cinza</option>
      <option value="#ffffff">Branco</option>
    </select>

    <label for="headImage">Imagem da Cabe√ßa (PNG/JPG):</label>
    <input type="file" id="headImage" accept="image/*" />

    <br />
    <button onclick="startGame()">Iniciar Jogo</button>
  </div>

  <!-- CONTROLES DO JOGO -->
  <div id="controls">
    <div id="score">Pontua√ß√£o: 0</div>
    <button onclick="togglePause()">Pausar / Continuar</button>
    <button onclick="returnToMenu()">Voltar ao Menu</button>
  </div>

  <!-- CANVAS DO JOGO -->
  <canvas id="game" width="400" height="400"></canvas>
  <div id="game-over">Game Over! Reiniciando...</div>

  <script>
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");
    const box = 20;
    const totalBoxes = canvas.width / box;

    let snake = [];
    let direction = "right";
    let nextDirection = "right";
    let food, score, gameLoop, isPaused = false;

    let bodyColor = "#00cc77";
    let headImage = new Image();
    let customHeadImageSet = false;

    const menu = document.getElementById("menu");
    const controls = document.getElementById("controls");
    const scoreDisplay = document.getElementById("score");
    const gameOverDiv = document.getElementById("game-over");
    const headImageInput = document.getElementById("headImage");

    // Se o usu√°rio carregar uma imagem, define como a cabe√ßa
    headImageInput.addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          headImage.src = e.target.result;
          customHeadImageSet = true;
        };
        reader.readAsDataURL(file);
      }
    });

    function startGame() {
      bodyColor = document.getElementById("bodyColor").value;

      // Define imagem padr√£o se nenhuma for carregada
      if (!customHeadImageSet) {
        headImage.src = "https://upload.wikimedia.org/wikipedia/commons/3/3c/Snake_icon.png";
      }

      // Mostra e oculta elementos
      menu.style.display = "none";
      controls.style.display = "block";
      canvas.style.display = "block";
      scoreDisplay.style.display = "block";
      gameOverDiv.style.display = "none";

      snake = [{ x: 8 * box, y: 8 * box }];
      direction = "right";
      nextDirection = "right";
      score = 0;
      scoreDisplay.textContent = "Pontua√ß√£o: 0";

      food = {
        x: Math.floor(Math.random() * totalBoxes) * box,
        y: Math.floor(Math.random() * totalBoxes) * box
      };

      clearInterval(gameLoop);
      gameLoop = setInterval(draw, 150);
    }

    function draw() {
      if (isPaused) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Fundo quadriculado
      for (let x = 0; x < canvas.width; x += box) {
        for (let y = 0; y < canvas.height; y += box) {
          ctx.fillStyle = (x / box + y / box) % 2 === 0 ? "#1a1a1a" : "#111";
          ctx.fillRect(x, y, box, box);
        }
      }

      // Comida
      ctx.fillStyle = "red";
      ctx.shadowColor = "red";
      ctx.shadowBlur = 10;
      ctx.fillRect(food.x, food.y, box, box);
      ctx.shadowBlur = 0;

      // Movimento
      let head = { x: snake[0].x, y: snake[0].y };
      direction = nextDirection;

      if (direction === "right") head.x += box;
      if (direction === "left") head.x -= box;
      if (direction === "up") head.y -= box;
      if (direction === "down") head.y += box;

      // Colis√£o com parede
      if (
        head.x < 0 || head.x >= canvas.width ||
        head.y < 0 || head.y >= canvas.height
      ) return gameOver();

      // Colis√£o com corpo
      for (let segment of snake.slice(1)) {
        if (head.x === segment.x && head.y === segment.y) {
          return gameOver();
        }
      }

      // Comeu a comida
      if (head.x === food.x && head.y === food.y) {
        score++;
        scoreDisplay.textContent = "Pontua√ß√£o: " + score;
        food = {
          x: Math.floor(Math.random() * totalBoxes) * box,
          y: Math.floor(Math.random() * totalBoxes) * box
        };
      } else {
        snake.pop();
      }

      snake.unshift(head);

      // Desenha a cobrinha
      for (let i = 0; i < snake.length; i++) {
        if (i === 0) {
          ctx.drawImage(headImage, snake[i].x, snake[i].y, box, box);
        } else {
          ctx.fillStyle = bodyColor;
          ctx.fillRect(snake[i].x, snake[i].y, box, box);
          ctx.strokeStyle = "#000";
          ctx.strokeRect(snake[i].x, snake[i].y, box, box);
        }
      }
    }

    function gameOver() {
      clearInterval(gameLoop);
      gameOverDiv.style.display = "block";
      setTimeout(() => returnToMenu(), 3000);
    }

    function togglePause() {
      isPaused = !isPaused;
    }

    function returnToMenu() {
      clearInterval(gameLoop);
      canvas.style.display = "none";
      controls.style.display = "none";
      scoreDisplay.style.display = "none";
      gameOverDiv.style.display = "none";
      menu.style.display = "block";
    }

    // Teclado
    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowUp" && direction !== "down") nextDirection = "up";
      else if (e.key === "ArrowDown" && direction !== "up") nextDirection = "down";
      else if (e.key === "ArrowLeft" && direction !== "right") nextDirection = "left";
      else if (e.key === "ArrowRight" && direction !== "left") nextDirection = "right";
      else if (e.key === " " || e.key === "p") togglePause();
    });
  </script>
</body>
</html>
